# 測試案例要儘可能一眼就知道它在做什麼

[心得] 為了修改某功能，回頭看測試案例，發現讀起來不順暢，仔細研究了一下，覺得測試案例太過於 DRY 了。這延伸出一個很重要的技巧：找到一個測試案例，而且只看它就好；如果你沒辦法從這個測試案例的描述看出前因後果，那就表示案例的 context 因為過度 DRY 而隱藏了太多細節。
測試案例最重要的就是它自己就能完整地描述一件事，讓看的人可以知道要完成這件事需要有哪些準備。


為了修改某功能，回頭看測試案例，發現讀起來不順暢，仔細研究了一下，覺得測試案例太過於 DRY 了。這延伸出一個很重要的技巧：找一個測試案例，而且只看它就好；如果你沒辦法從這個測試案例的描述看出前因後果，那就表示案例的 context 因為透過 DRY 而隱藏了太多細節。

測試案例最重要的就是能完整地描述一件事，讓看的人可以知道他需要準備哪些前置作業來完成這件事。


---

對於測試案例重構  91 哥的建議

哈哈哈，懂我說的，為什麼我可以接受測試案例複製貼上了吧？

重點在 specification, not testing。

testing code 對 duplicate code 的 bad smell, 重構時機請放在需求異動的時候，你是不是又要來 N 次複製貼上。

如果是，那時候再重構測試程式就好。

--
UI testing 除外，一開始的 page object pattern 是基本的重構救命符。

最多只接受 call stack 深度是 2 的方式，也就是一個 private function or other class public function。

而這個 function 一定是因為某一次需求異動發現要改的同一份東西太多，才會抽走的。不會在一開始就做成那樣。

這樣才有機會花剛好的力氣。

況且，測試案例砍掉重寫的 effort 是低的，抽一大堆，乾的要死時，你要砍掉的猶豫程度，可能是複製貼上的 10 倍。

期望讓看的人，用最短的時間知道，scenario 的意思以及需求的意義。

期望讓用的人，用最短的時間知道，我該怎麼用這個 API，有什麼要注意的地方。

期望讓追問題的人，用最短的時間找到，從哪一刀切進去就能抓到不如預期的地方。


